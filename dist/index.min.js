if(typeof Object.assign!="function"){Object.defineProperty(Object,"assign",{value:function t(e,i){if(e==null){throw new TypeError("Cannot convert undefined or null to object")}var n=Object(e);for(var o=1;o<arguments.length;o++){var s=arguments[o];if(s!=null){for(var a in s){if(Object.prototype.hasOwnProperty.call(s,a)){n[a]=s[a]}}}}return n},writable:true,configurable:true})}if(typeof Array.from!="function"){Array.from=function(t){return[].slice.call(t)}}var buildElement=function(t){var e=document.implementation.createHTMLDocument("");e.body.innerHTML=t;return Array.from(e.body.children)[0]};var triggerEvent=function(t,e){var i=document.createEvent("HTMLEvents");i.initEvent(e,true,false);t.dispatchEvent(i)};var definePinchZoom=function(){var t=function(t,e){this.el=t;this.zoomFactor=1;this.lastScale=1;this.offset={x:0,y:0};this.initialOffset={x:0,y:0};this.options=Object.assign({},this.defaults,e);this.setupMarkup();this.bindEvents();this.update();if(this.isImageLoaded(this.el)){this.updateAspectRatio();this.setupOffsets()}this.enable()},e=function(t,e){return t+e},i=function(t,e){return t>e-.01&&t<e+.01};t.prototype={defaults:{tapZoomFactor:2,zoomOutFactor:1.3,animationDuration:300,maxZoom:4,minZoom:.5,draggableUnzoomed:true,lockDragAxis:false,setOffsetsOnce:false,use2d:true,useMouseWheel:false,useDoubleTap:true,zoomStartEventName:"pz_zoomstart",zoomUpdateEventName:"pz_zoomupdate",zoomEndEventName:"pz_zoomend",dragStartEventName:"pz_dragstart",dragUpdateEventName:"pz_dragupdate",dragEndEventName:"pz_dragend",doubleTapEventName:"pz_doubletap",mouseWheelEventName:"pz_mousewheel",verticalPadding:0,horizontalPadding:0,onZoomStart:null,onZoomEnd:null,onZoomUpdate:null,onDragStart:null,onDragEnd:null,onDragUpdate:null,onDoubleTap:null,onMouseWheel:null,containerPos:"relative",zoomPos:"absolute"},handleDragStart:function(t){triggerEvent(this.el,this.options.dragStartEventName);if(typeof this.options.onDragStart=="function"){this.options.onDragStart(this,t)}this.stopAnimation();this.lastDragPosition=false;this.hasInteraction=true;this.handleDrag(t)},handleDrag:function(t){var e=t.type==="touchmove"?this.getTouches(t)[0]:this.getPointer(t);this.drag(e,this.lastDragPosition);this.offset=this.sanitizeOffset(this.offset);this.lastDragPosition=e},handleDragEnd:function(){triggerEvent(this.el,this.options.dragEndEventName);if(typeof this.options.onDragEnd=="function"){this.options.onDragEnd(this,event)}this.end()},handleZoomStart:function(t){triggerEvent(this.el,this.options.zoomStartEventName);if(typeof this.options.onZoomStart=="function"){this.options.onZoomStart(this,t)}this.stopAnimation();this.lastScale=1;this.nthZoom=0;this.lastZoomCenter=false;this.hasInteraction=true},handleZoom:function(t,e){var i=this.getTouchCenter(this.getTouches(t)),n=e/this.lastScale;this.lastScale=e;this.nthZoom+=1;if(this.nthZoom>3){this.scale(n,i);this.drag(i,this.lastZoomCenter)}this.lastZoomCenter=i},handleZoomEnd:function(){triggerEvent(this.el,this.options.zoomEndEventName);if(typeof this.options.onZoomEnd=="function"){this.options.onZoomEnd(this,event)}this.end()},handleDoubleTap:function(t){var e=this.getTouches(t)[0],i=this.zoomFactor>1?1:this.options.tapZoomFactor,n=this.zoomFactor,o=function(t){this.scaleTo(n+t*(i-n),e)}.bind(this);if(this.hasInteraction){return}this.isDoubleTap=true;if(n>i){e=this.getCurrentZoomCenter()}this.animate(this.options.animationDuration,o,this.swing);triggerEvent(this.el,this.options.doubleTapEventName);if(typeof this.options.onDoubleTap=="function"){this.options.onDoubleTap(this,t)}},handleMouseWheel:function(t){var e=this.getPointer(t),i=Math.min(Math.max(this.options.minZoom,this.lastScale+t.deltaY*-.01),this.options.maxZoom),n=i/this.lastScale;this.scale(n,e);this.lastScale=i;this.update();triggerEvent(this.el,this.options.mouseWheelEventName);if(typeof this.options.onMouseWheel=="function"){this.options.onMouseWheel(this,t)}},computeInitialOffset:function(){this.initialOffset={x:-Math.abs(this.el.offsetWidth*this.getInitialZoomFactor()-this.container.offsetWidth)/2,y:-Math.abs(this.el.offsetHeight*this.getInitialZoomFactor()-this.container.offsetHeight)/2}},resetOffset:function(){this.offset.x=this.initialOffset.x;this.offset.y=this.initialOffset.y},isImageLoaded:function(t){if(t.nodeName==="IMG"){return t.complete&&t.naturalHeight!==0}else{return Array.from(t.querySelectorAll("img")).every(this.isImageLoaded)}},setupOffsets:function(){if(this.options.setOffsetsOnce&&this._isOffsetsSet){return}this._isOffsetsSet=true;this.computeInitialOffset();this.resetOffset()},sanitizeOffset:function(t){var e=this.el.offsetWidth*this.getInitialZoomFactor()*this.zoomFactor;var i=this.el.offsetHeight*this.getInitialZoomFactor()*this.zoomFactor;var n=e-this.getContainerX()+this.options.horizontalPadding,o=i-this.getContainerY()+this.options.verticalPadding,s=Math.max(n,0),a=Math.max(o,0),r=Math.min(n,0)-this.options.horizontalPadding,h=Math.min(o,0)-this.options.verticalPadding;return{x:Math.min(Math.max(t.x,r),s),y:Math.min(Math.max(t.y,h),a)}},scaleTo:function(t,e){this.scale(t/this.zoomFactor,e)},scale:function(t,e){t=this.scaleZoomFactor(t);this.addOffset({x:(t-1)*(e.x+this.offset.x),y:(t-1)*(e.y+this.offset.y)});triggerEvent(this.el,this.options.zoomUpdateEventName);if(typeof this.options.onZoomUpdate=="function"){this.options.onZoomUpdate(this,event)}},scaleZoomFactor:function(t){var e=this.zoomFactor;this.zoomFactor*=t;this.zoomFactor=Math.min(this.options.maxZoom,Math.max(this.zoomFactor,this.options.minZoom));return this.zoomFactor/e},canDrag:function(){return this.options.draggableUnzoomed||!i(this.zoomFactor,1)},drag:function(t,e){if(e){if(this.options.lockDragAxis){if(Math.abs(t.x-e.x)>Math.abs(t.y-e.y)){this.addOffset({x:-(t.x-e.x),y:0})}else{this.addOffset({y:-(t.y-e.y),x:0})}}else{this.addOffset({y:-(t.y-e.y),x:-(t.x-e.x)})}triggerEvent(this.el,this.options.dragUpdateEventName);if(typeof this.options.onDragUpdate=="function"){this.options.onDragUpdate(this,event)}}},getTouchCenter:function(t){return this.getVectorAvg(t)},getVectorAvg:function(t){return{x:t.map(function(t){return t.x}).reduce(e)/t.length,y:t.map(function(t){return t.y}).reduce(e)/t.length}},addOffset:function(t){this.offset={x:this.offset.x+t.x,y:this.offset.y+t.y}},sanitize:function(){if(this.zoomFactor<this.options.zoomOutFactor){this.zoomOutAnimation()}else if(this.isInsaneOffset(this.offset)){this.sanitizeOffsetAnimation()}},isInsaneOffset:function(t){var e=this.sanitizeOffset(t);return e.x!==t.x||e.y!==t.y},sanitizeOffsetAnimation:function(){var e=this.sanitizeOffset(this.offset),i={x:this.offset.x,y:this.offset.y},t=function(t){this.offset.x=i.x+t*(e.x-i.x);this.offset.y=i.y+t*(e.y-i.y);this.update()}.bind(this);this.animate(this.options.animationDuration,t,this.swing)},zoomOutAnimation:function(){if(this.zoomFactor===1){return}var e=this.zoomFactor,i=1,n=this.getCurrentZoomCenter(),t=function(t){this.scaleTo(e+t*(i-e),n)}.bind(this);this.animate(this.options.animationDuration,t,this.swing)},updateAspectRatio:function(){this.unsetContainerY();this.setContainerY(this.container.parentElement.offsetHeight)},getInitialZoomFactor:function(){var t=this.container.offsetWidth/this.el.offsetWidth;var e=this.container.offsetHeight/this.el.offsetHeight;return Math.min(t,e)},getAspectRatio:function(){return this.el.offsetWidth/this.el.offsetHeight},getCurrentZoomCenter:function(){var t=this.offset.x-this.initialOffset.x;var e=-1*this.offset.x-t/(1/this.zoomFactor-1);var i=this.offset.y-this.initialOffset.y;var n=-1*this.offset.y-i/(1/this.zoomFactor-1);return{x:e,y:n}},getTouches:function(t){var e=this.container.getBoundingClientRect();var i=document.documentElement.scrollTop||document.body.scrollTop;var n=document.documentElement.scrollLeft||document.body.scrollLeft;var o=e.top+i;var s=e.left+n;if(t.type==="mouseup"||t.type==="click"){return[{x:t.pageX-s,y:t.pageY-o}]}return Array.prototype.slice.call(t.touches).map(function(t){return{x:t.pageX-s,y:t.pageY-o}})},getPointer:function(t){var e=this.container.getBoundingClientRect();var i=document.documentElement.scrollTop||document.body.scrollTop;var n=document.documentElement.scrollLeft||document.body.scrollLeft;var o=e.top+i;var s=e.left+n;return{x:t.pageX-s,y:t.pageY-o}},animate:function(i,n,o,s){var a=(new Date).getTime(),r=function(){if(!this.inAnimation){return}var t=(new Date).getTime()-a,e=t/i;if(t>=i){n(1);if(s){s()}this.update();this.stopAnimation();this.update()}else{if(o){e=o(e)}n(e);this.update();requestAnimationFrame(r)}}.bind(this);this.inAnimation=true;requestAnimationFrame(r)},stopAnimation:function(){this.inAnimation=false},swing:function(t){return-Math.cos(t*Math.PI)/2+.5},getContainerX:function(){return this.container.offsetWidth},getContainerY:function(){return this.container.offsetHeight},setContainerY:function(t){return this.container.style.height=t+"px"},unsetContainerY:function(){this.container.style.height=null},setupMarkup:function(){this.container=buildElement('<div class="pinch-zoom-container"></div>');this.el.parentNode.insertBefore(this.container,this.el);this.container.appendChild(this.el);this.container.style.overflow="hidden";this.container.style.position=this.options.containerPos;this.el.style.webkitTransformOrigin="0% 0%";this.el.style.mozTransformOrigin="0% 0%";this.el.style.msTransformOrigin="0% 0%";this.el.style.oTransformOrigin="0% 0%";this.el.style.transformOrigin="0% 0%";this.el.style.position=this.options.zoomPos;this.el.style.backfaceVisibility="hidden";this.el.style.willChange="transform"},end:function(){this.hasInteraction=false;this.sanitize();this.update()},bindEvents:function(){var e=this;n(this.container,this);this.resizeHandler=this.update.bind(this);window.addEventListener("resize",this.resizeHandler);Array.from(this.el.querySelectorAll("img")).forEach(function(t){t.addEventListener("load",e.update.bind(e))});if(this.el.nodeName==="IMG"){this.el.addEventListener("load",this.update.bind(this))}},update:function(t){if(t&&t.type==="resize"){this.updateAspectRatio();this.setupOffsets()}if(t&&t.type==="load"){this.updateAspectRatio();this.setupOffsets()}if(this.updatePlanned){return}this.updatePlanned=true;window.setTimeout(function(){this.updatePlanned=false;var t=this.getInitialZoomFactor()*this.zoomFactor,e=-this.offset.x/t,i=-this.offset.y/t,n="scale3d("+t+", "+t+",1) "+"translate3d("+e+"px,"+i+"px,0px)",o="scale("+t+", "+t+") "+"translate("+e+"px,"+i+"px)",s=function(){if(this.clone){this.clone.parentNode.removeChild(this.clone);delete this.clone}}.bind(this);if(!this.options.use2d||this.hasInteraction||this.inAnimation){this.is3d=true;s();this.el.style.webkitTransform=n;this.el.style.mozTransform=o;this.el.style.msTransform=o;this.el.style.oTransform=o;this.el.style.transform=n}else{if(this.is3d){this.clone=this.el.cloneNode(true);this.clone.style.pointerEvents="none";this.container.appendChild(this.clone);window.setTimeout(s,200)}this.el.style.webkitTransform=o;this.el.style.mozTransform=o;this.el.style.msTransform=o;this.el.style.oTransform=o;this.el.style.transform=o;this.is3d=false}}.bind(this),0)},enable:function(){this.enabled=true},disable:function(){this.enabled=false},destroy:function(){window.removeEventListener("resize",this.resizeHandler);if(this.container){this.container.remove();this.container=null}}};var n=function(t,i){var n=null,o=0,s=null,e=null,a=function(t,e){if(n!==t){if(n&&!t){switch(n){case"zoom":i.handleZoomEnd(e);break;case"drag":i.handleDragEnd(e);break}}switch(t){case"zoom":i.handleZoomStart(e);break;case"drag":i.handleDragStart(e);break}}n=t},r=function(t){if(o===2){a("zoom")}else if(o===1&&i.canDrag()){a("drag",t)}else{a(null,t)}},h=function(t){return Array.from(t).map(function(t){return{x:t.pageX,y:t.pageY}})},f=function(t,e){var i,n;i=t.x-e.x;n=t.y-e.y;return Math.sqrt(i*i+n*n)},l=function(t,e){var i=f(t[0],t[1]),n=f(e[0],e[1]);return n/i},u=function(t){t.stopPropagation();t.preventDefault()},c=function(t){var e=(new Date).getTime();if(o>1){s=null}if(e-s<300){u(t);i.handleDoubleTap(t);switch(n){case"zoom":i.handleZoomEnd(t);break;case"drag":i.handleDragEnd(t);break}}else{i.isDoubleTap=false}if(o===1){s=e}},d=true;t.addEventListener("touchstart",function(t){if(i.enabled){d=true;o=t.touches.length;if(i.options.useDoubleTap){c(t)}}},{passive:false});t.addEventListener("touchmove",function(t){if(i.enabled&&!i.isDoubleTap){if(d){r(t);if(n){u(t)}e=h(t.touches)}else{switch(n){case"zoom":if(e.length==2&&t.touches.length==2){i.handleZoom(t,l(e,h(t.touches)))}break;case"drag":i.handleDrag(t);break}if(n){u(t);i.update()}}d=false}},{passive:false});t.addEventListener("touchend",function(t){if(i.enabled){o=t.touches.length;r(t)}});if(i.options.useMouseWheel){t.addEventListener("mousewheel",function(t){if(i.enabled){u(t);i.handleMouseWheel(t)}});t.addEventListener("mousedown",function(t){if(i.enabled){d=true;o=1}},{passive:true});t.addEventListener("mousemove",function(t){if(i.enabled){if(d){r(t);if(n){u(t)}}else{if(n==="drag"){i.handleDrag(t)}if(n){u(t);i.update()}}d=false}},{passive:false});t.addEventListener("mouseup",function(t){if(i.enabled){o=0;r(t)}},{passive:true})}};return t};var PinchZoom=definePinchZoom();export default PinchZoom;